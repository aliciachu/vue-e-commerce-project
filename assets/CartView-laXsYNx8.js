import{a as m}from"./axios-nwi5g7Xq.js";import{_ as w,c as u,d as e,F as k,f as T,t as n,a as d,w as q,r as f,o as _,g as L,b as v,h as y,v as C,z as p}from"./index-dPXdaXYj.js";var U={VITE_URL:"https://ec-course-api.hexschool.io",VITE_PATH:"amaaaa",BASE_URL:"/vue-e-commerce-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:b,VITE_PATH:h}=U,E={data(){return{status:{cartQtyLoading:"",delCartLoading:""},carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart(){m.get(`${b}/v2/api/${h}/cart`).then(a=>{console.log(a),this.carts=a.data.data})},changeCartQty(a,l=1){const g={product_id:a.product_id,qty:l};this.status.cartQtyLoading=a.id,m.put(`${b}/v2/api/${h}/cart/${a.id}`,{data:g}).then(x=>{this.status.cartQtyLoading="",this.getCart()})},removeCartItem(a){this.status.delCartLoading=a,m.delete(`${b}/v2/api/${h}/cart/${a}`).then(l=>{this.status.delCartLoading="",this.getCart()})},createOrder(){m.post(`${b}/v2/api/${h}/order`,{data:this.form}).then(a=>{this.$router.push(`/Checkout/${a.data.orderId}`),this.$refs.form.resetForm(),this.form.message="",this.getCart()})}},mounted(){this.getCart()}},N={class:"container"},I={class:"mt-3"},Q=e("h3",{class:"mt-3 mb-4"},"購物車",-1),S={class:"row"},D={class:"col-md-8"},P={class:"table"},R=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"border-0 ps-0"}),e("th",{scope:"col",class:"border-0 ps-0"},"品名"),e("th",{scope:"col",class:"border-0"},"數量/單位"),e("th",{scope:"col",class:"border-0"},"單價"),e("th",{scope:"col",class:"border-0"},"總價")])],-1),$={class:"border-0 align-middle"},j=["disabled","onClick"],A={key:0,class:"fas fa-spinner fa-pulse"},B={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},O=["src"],F={class:"mb-0 fw-bold ms-3 d-inline-block"},z={class:"border-0 align-middle",style:{"max-width":"160px"}},H={class:"input-group pe-5"},M=e("div",{class:"input-group-prepend"},[e("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},[e("i",{class:"fas fa-minus"})])],-1),G={class:"input-group input-group-sm"},J=["disabled","onClick"],K=["onUpdate:modelValue","onChange"],W={class:"input-group-text",id:"basic-addon2"},X=["onClick"],Y=e("div",{class:"input-group-append"},[e("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},[e("i",{class:"fas fa-plus"})])],-1),Z={class:"border-0 align-middle"},ee={class:"mb-0 ms-auto"},se={class:"border-0 align-middle"},te=e("i",{class:"fas fa-times"},null,-1),oe={class:"col-md-4"},le={class:"border p-4 mb-4"},ae=e("h4",{class:"fw-bold mb-4"},"訂單",-1),de={class:"table text-muted border-bottom"},ne=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"Subtotal",-1),re={class:"text-end border-0 px-0 pt-4"},ie=e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"Payment"),e("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),ce={class:"d-flex justify-content-between mt-4"},me=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),ue={class:"mb-0 h4 fw-bold"},_e={class:"my-5 row justify-content-center"},pe={class:"mb-3"},be=e("label",{for:"email",class:"form-label"},"Email",-1),he={class:"mb-3"},fe=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ge={class:"mb-3"},ve=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ye={class:"mb-3"},Ce=e("label",{for:"address",class:"form-label"},"收件人地址",-1),xe={class:"mb-3"},Ve=e("label",{for:"message",class:"form-label"},"留言",-1),we=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function ke(a,l,g,x,t,r){const i=f("v-field"),c=f("error-message"),V=f("v-form");return _(),u("div",N,[e("div",I,[Q,e("div",S,[e("div",D,[e("table",P,[R,e("tbody",null,[(_(!0),u(k,null,T(t.carts.carts,s=>(_(),u("tr",{key:s.id,class:"border-bottom border-top"},[e("td",$,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===t.status.delCartLoading,onClick:o=>r.removeCartItem(s.id)},[s.id===t.status.delCartLoading?(_(),u("i",A)):L("",!0),v(" x ")],8,j)]),e("th",B,[e("img",{src:s.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,O),e("p",F,n(s.product.title),1)]),e("td",z,[e("div",H,[M,e("div",G,[e("button",{type:"button",class:"btn btn-outline-primary",disabled:s.qty===1,onClick:o=>{s.qty--,r.changeCartQty(s,s.qty)}}," - ",8,J),y(e("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":o=>s.qty=o,readonly:"",onChange:o=>r.changeCartQty(s,s.qty)},null,40,K),[[C,s.qty]]),e("span",W,n(s.product.unit),1),e("button",{type:"button",class:"btn btn-outline-primary",onClick:o=>{s.qty++,r.changeCartQty(s,s.qty)}}," + ",8,X)]),Y])]),e("td",Z,[e("p",ee,"NT$"+n(s.product.price),1)]),e("td",se,[te,v("NT$"+n(s.total),1)])]))),128))])])]),e("div",oe,[e("div",le,[ae,e("table",de,[e("tbody",null,[e("tr",null,[ne,e("td",re,"NT$"+n(t.carts.final_total),1)]),ie])]),e("div",ce,[me,e("p",ue,"NT$"+n(t.carts.final_total),1)])])])])]),e("div",_e,[d(V,{ref:"form",class:"col-md-6",onSubmit:r.createOrder},{default:q(({errors:s})=>[e("div",pe,[be,d(i,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.form.user.email,"onUpdate:modelValue":l[0]||(l[0]=o=>t.form.user.email=o)},null,8,["class","modelValue"]),d(c,{name:"email",class:"invalid-feedback"})]),e("div",he,[fe,d(i,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":l[1]||(l[1]=o=>t.form.user.name=o)},null,8,["class","modelValue"]),d(c,{name:"姓名",class:"invalid-feedback"})]),e("div",ge,[ve,d(i,{id:"tel",name:"電話",type:"text",class:p(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rule:"required",modelValue:t.form.user.tel,"onUpdate:modelValue":l[2]||(l[2]=o=>t.form.user.tel=o)},null,8,["class","modelValue"]),d(c,{name:"電話",class:"invalid-feedback"})]),e("div",ye,[Ce,d(i,{id:"address",name:"地址",type:"text",class:p(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":l[3]||(l[3]=o=>t.form.user.address=o)},null,8,["class","modelValue"]),d(c,{name:"地址",class:"invalid-feedback"})]),e("div",xe,[Ve,y(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":l[4]||(l[4]=o=>t.form.message=o)},null,512),[[C,t.form.message]])]),we]),_:1},8,["onSubmit"])])])}const Le=w(E,[["render",ke]]);export{Le as default};
